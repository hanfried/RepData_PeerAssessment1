---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

1. Load the data
```{r loading_the_data,echo=TRUE}
download.file(
  "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",
  "activity.zip",
  method = "wget"
)
unzip("activity.zip")
activity <- read.csv("activity.csv")
```

Let's take a short look on the loaded data:
```{r short_look_to_loaded_data,echo=TRUE}
dim(activity)
head(activity)
str(activity)
```

2. Process the data into a format suitable for your analysis
```{r pre_process_the_data_into_suitable_format}
library(dplyr,warn.conflicts = FALSE)
library(lubridate)
library(ggplot2)
activity <- mutate(activity,date = ymd(date))
```

## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day


```{r calculate_steps_by_day,echo=TRUE}
steps_by_day <- activity %>%
  group_by(date) %>%
  summarize(total_steps = sum(steps,na.rm=TRUE))
```

2. Make a histogram of the total number of steps each day
```{r histogrom_steps_by_day,echo=TRUE}
ggplot(steps_by_day,aes(total_steps)) + 
  geom_histogram(bins = 20,alpha=0.8) +
  ggtitle("Histogram of total number of steps each day") +
  xlab("Total Steps a day") +
  ylab("Occurences") +
  scale_y_discrete() +
  geom_vline(aes(xintercept = mean(total_steps),colour="Mean"),show.legend=TRUE) +
  geom_vline(aes(xintercept = median(total_steps),colour="Median"),show.legend=TRUE) +
  scale_colour_manual("Statistics",values=c("red","blue"))
```

3. Calculate and report the mean and median of the total number of steps taken per day
```{r mean_median_steps_by_day,echo=TRUE}
mean(steps_by_day$total_steps)
median(steps_by_day$total_steps)
```
## What is the average daily activity pattern?

1, A time series plot of the 5 minute interval and the average number of steps taken, averaged across all days

```{r average_steps_by_interval,echo=TRUE}
mean_steps_by_interval <- activity %>%
  group_by(interval) %>%
  summarize(average_steps = mean(steps,na.rm=TRUE))

interval_with_most_steps <-
  mean_steps_by_interval$interval[which.max(mean_steps_by_interval$average_steps)]

ggplot(mean_steps_by_interval,aes(x = interval,y = average_steps)) +
  geom_line() +
  ggtitle("Average steps by time of day") +
  xlab("Time of day") +
  ylab("Number of average steps") +
  scale_x_discrete(breaks=c(200*0:12),labels=c(sprintf("%i:00",2*0:12))) +
  geom_vline(aes(xintercept = interval_with_most_steps,colour="red"),
             linetype = 2,
             show.legend = FALSE) +
  geom_label(aes(x = 1600,
                 y = max(mean_steps_by_interval$average_steps),
                 label = sprintf("5minute interval at %i:%0i has most steps on average",
                                 floor(interval_with_most_steps/100),
                                 interval_with_most_steps %% 100)),
             show.legend = FALSE)
```

2. Wich 5-minute interval, on average across all the days, contains the maximum number of steps?
```{r interval_with_maximum_average_steps_by_day}
interval_with_most_steps
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
